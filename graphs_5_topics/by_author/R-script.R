# Export image with width=700 and height=1300


library('ggplot2')

multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
  library(grid)
  
  # Make a list from the ... arguments and plotlist
  plots <- c(list(...), plotlist)
  
  numPlots = length(plots)
  
  # If layout is NULL, then use 'cols' to determine layout
  if (is.null(layout)) {
    # Make the panel
    # ncol: Number of columns of plots
    # nrow: Number of rows needed, calculated from # of cols
    layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
                     ncol = cols, nrow = ceiling(numPlots/cols))
  }
  
  if (numPlots==1) {
    print(plots[[1]])
    
  } else {
    # Set up the page
    grid.newpage()
    pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
    
    # Make each plot, in the correct location
    for (i in 1:numPlots) {
      # Get the i,j matrix positions of the regions that contain this subplot
      matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
      
      print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
                                      layout.pos.col = matchidx$col))
    }
  }
}

data <- read.csv('./author_probs_for_R.csv', sep=';', encoding='UTF-8', stringsAsFactors=FALSE)

krylov <- data[data$Author=='????????????, ???????? ??????????????????', ]
suhovo_kobylin <- data[data$Author=='????????????-??????????????, ?????????????????? ????????????????????', ]
chekhov <- data[data$Author=='??????????, ?????????? ????????????????', ]
pushkin <- data[data$Author=='????????????, ?????????????????? ??????????????????', ]
turgenev <- data[data$Author=='????????????????, ???????? ??????????????????', ]
bulgakov <- data[data$Author=='????????????????, ???????????? ??????????????????????', ]
gogol <- data[data$Author=='????????????, ?????????????? ????????????????????', ]
ostrovskiy <- data[data$Author=='????????????????????, ?????????????????? ????????????????????', ]
shakhovskoy <- data[data$Author=='??????????????????, ?????????????????? ??????????????????????????', ]
sumarokov <- data[data$Author=='??????????????????, ?????????????????? ????????????????', ]
tolstoylev <- data[data$Author=='??????????????, ?????? ????????????????????', ]
tolstoyalexey <- data[data$Author=='??????????????, ?????????????? ????????????????????????????', ]
fonvizin <- data[data$Author=='????????????????, ?????????? ????????????????', ]
blok <- data[data$Author=='????????, ?????????????????? ??????????????????????????', ]
gumilev <- data[data$Author=='??????????????, ?????????????? ????????????????????', ]

krylov_graph <- ggplot(krylov, aes(x=Topic, y=Probability)) + geom_bar(stat='identity') + labs(title="????????????", x='', y='??????????????????????') + scale_y_continuous(limits=c(0,100)) + theme(axis.text.x=element_text(angle = 50, hjust = 1), axis.text=element_text(size=12))

suhovo_kobylin_graph <- ggplot(suhovo_kobylin, aes(x=Topic, y=Probability)) + geom_bar(stat='identity') + labs(title="????????????-??????????????", x='', y='??????????????????????') + scale_y_continuous(limits=c(0,100)) + theme(axis.text.x=element_text(angle = 50, hjust = 1), axis.text=element_text(size=12))

chekhov_graph <- ggplot(chekhov, aes(x=Topic, y=Probability)) + geom_bar(stat='identity') + labs(title="??????????", x='', y='??????????????????????') + scale_y_continuous(limits=c(0,100)) + theme(axis.text.x=element_text(angle = 50, hjust = 1), axis.text=element_text(size=12))

pushkin_graph <- ggplot(pushkin, aes(x=Topic, y=Probability)) + geom_bar(stat='identity') + labs(title="????????????", x='', y='??????????????????????') + scale_y_continuous(limits=c(0,100)) + theme(axis.text.x=element_text(angle = 50, hjust = 1), axis.text=element_text(size=12))

turgenev_graph <- ggplot(turgenev, aes(x=Topic, y=Probability)) + geom_bar(stat='identity') + labs(title="????????????????", x='', y='???????????????????????') + scale_y_continuous(limits=c(0,100)) + theme(axis.text.x=element_text(angle = 50, hjust = 1), axis.text=element_text(size=12))

bulgakov_graph <- ggplot(bulgakov, aes(x=Topic, y=Probability)) + geom_bar(stat='identity') + labs(title="????????????????", x='', y='??????????????????????') + scale_y_continuous(limits=c(0,100)) + theme(axis.text.x=element_text(angle = 50, hjust = 1), axis.text=element_text(size=12))

gogol_graph <- ggplot(gogol, aes(x=Topic, y=Probability)) + geom_bar(stat='identity') + labs(title="????????????", x='', y='??????????????????????') + scale_y_continuous(limits=c(0,100)) + theme(axis.text.x=element_text(angle = 50, hjust = 1), axis.text=element_text(size=12))

ostrovskiy_graph <- ggplot(ostrovskiy, aes(x=Topic, y=Probability)) + geom_bar(stat='identity') + labs(title="????????????????????", x='', y='??????????????????????') + scale_y_continuous(limits=c(0,100)) + theme(axis.text.x=element_text(angle = 50, hjust = 1), axis.text=element_text(size=12))

shakhovskoy_graph <- ggplot(shakhovskoy, aes(x=Topic, y=Probability)) + geom_bar(stat='identity') + labs(title="??????????????????", x='', y='??????????????????????') + scale_y_continuous(limits=c(0,100)) + theme(axis.text.x=element_text(angle = 50, hjust = 1), axis.text=element_text(size=12))

sumarokov_graph <- ggplot(sumarokov, aes(x=Topic, y=Probability)) + geom_bar(stat='identity') + labs(title="??????????????????", x='', y='??????????????????????') + scale_y_continuous(limits=c(0,100)) + theme(axis.text.x=element_text(angle = 50, hjust = 1), axis.text=element_text(size=12))

tolstoylev_graph <- ggplot(tolstoylev, aes(x=Topic, y=Probability)) + geom_bar(stat='identity') + labs(title="?????? ??????????????", x='', y='??????????????????????') + scale_y_continuous(limits=c(0,100)) + theme(axis.text.x=element_text(angle = 50, hjust = 1), axis.text=element_text(size=12))

tolstoyalexey_graph <- ggplot(tolstoyalexey, aes(x=Topic, y=Probability)) + geom_bar(stat='identity') + labs(title="?????????????? ??????????????", x='', y='??????????????????????') + scale_y_continuous(limits=c(0,100)) + theme(axis.text.x=element_text(angle = 50, hjust = 1), axis.text=element_text(size=12))

fonvizin_graph <- ggplot(fonvizin, aes(x=Topic, y=Probability)) + geom_bar(stat='identity') + labs(title="????????????????", x='', y='??????????????????????') + scale_y_continuous(limits=c(0,100)) + theme(axis.text.x=element_text(angle = 50, hjust = 1), axis.text=element_text(size=12))

blok_graph <- ggplot(blok, aes(x=Topic, y=Probability)) + geom_bar(stat='identity') + labs(title="????????", x='', y='??????????????????????') + scale_y_continuous(limits=c(0,100)) + theme(axis.text.x=element_text(angle = 50, hjust = 1), axis.text=element_text(size=12))

gumilev_graph <- ggplot(gumilev, aes(x=Topic, y=Probability)) + geom_bar(stat='identity') + labs(title="??????????????", x='', y='??????????????????????') + scale_y_continuous(limits=c(0,100)) + theme(axis.text.x=element_text(angle = 50, hjust = 1), axis.text=element_text(size=12))

multiplot(krylov_graph , suhovo_kobylin_graph , chekhov_graph , pushkin_graph , turgenev_graph,  bulgakov_graph , gogol_graph , ostrovskiy_graph , shakhovskoy_graph , sumarokov_graph , tolstoylev_graph,  tolstoyalexey_graph, fonvizin_graph, blok_graph, gumilev_graph, cols=5)

